---
layout:     post
title:      多线程前言
subtitle:   基础
date:       2023-11-02
author:     lx
header-img: img/Embedded-System/ES.png
catalog: true
tags:
    - 多线程
---

## 并发  and  并行
并发：一个处理器同时处理多个任务。逻辑上同时发生。

**举例：** 
并发是指一个cpu同时处理三个任务，每一时刻只能有一个任务在执行，这三个任务轮换执行；只是把cpu分成若干个时间切片，每个任务交替执行，在宏观上具有同时执行的效果。

并行：多个处理器或者是多核的处理器同时处理多个不同的任务。物理上同时发生。

**举例：**
并行是指三个任务在三个cpu（或者是多核处理器）上同时执行，无论从微观还是宏观上来说都是同时执行的。



## 进程

进程：狭义上讲就是一段程序的执行过程；广义上是程序在某个数据集上的一次运行活动，是操作系统进行资源分配和保护的基本单位。

**举例：**
同时挂三个 QQ 号，它们就对应三个 QQ 进程，退出一个就会杀死一个对应的进程。但是，就算你把这三个 QQ 全都退出了，QQ 这个程序死亡了吗？显然没有。

进程不仅包含正在运行的程序实体，并且包括这个运行的程序中占据的所有系统资源，比如说 CPU、内存、网络资源等

**进程有三部分组成：**
 - 进程控制块 PCB（Process Control Block ）
 - 数据段
 - 程序段




## 线程

线程：一个进程中可以有多个线程，共享这个进程的资源。线程是系统运算调度的最小单元。

**举例：**
 - 计算机分核心为cpu，就像一座工厂时刻在运行。
 - 进程就是一个工厂的车间，它代表cpu处理单个任务。
 - 一个车间里有许多工人，他们协同完成一个任务。这些工人就是一个个线程，一个进程可以包含多个线程，至少有一个主线程。
 - 车间的空间是工人共享的，即进程的内存空间是共享的，每个线程都可以使用这些共享内存。
 - 车间里每个房间的大小不同，有些房间只能容纳一人，里面有人时其他人就不能进去了；即一个线程使用共享内存空间时，必须等待其他线程释放后才能使用这个内存块。
 - 怎么保证一个人使用时其他人进不去？就是加锁。这就是互斥锁，防止多个线程访问同一块内存区域。
 - 还有的房间可以同时进去多个人，即同一块内存区域可以提供给固定数目的线程使用。
 - 这时的解决方法，就是在门口挂 n 把钥匙。进去的人就取一把钥匙，出来时再把钥匙挂回原处。后到的人发现钥匙架空了，就知道必须在门口排队等着了。这种做法叫做 "信号量"（Semaphore），用来保证多个线程不会互相冲突。
 


